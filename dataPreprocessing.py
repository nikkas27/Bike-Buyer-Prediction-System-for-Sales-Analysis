import pandas as pd
import csv
import random
import numpy as np


VTargetBuy = pd.read_csv("F:/Cleveland State University/Fall 19/CIS 660/Assign 1/VTargetBuy.csv")

#print(VTargetBuy.columns)

# print(VTargetBuy.isnull().any())

yearly_income = VTargetBuy.values[:,0]
TotalChildren = VTargetBuy.values[:,1]
NumberChildrenAtHome = VTargetBuy.values[:,2]
EnglishOccupation = VTargetBuy.values[:,3]
NumberCarsOwned = VTargetBuy.values[:,4]
DateFirstPurchase = VTargetBuy.values[:,5]
CommuteDistance = VTargetBuy.values[:,6]
age = VTargetBuy.values[:,7]

# print(yearly_income)
# print(age)
max_income = max(yearly_income)
min_income = min(yearly_income)

# print("MAX:", max_income, "MIN:", min_income)

# with open('F:/Cleveland State University/Fall 19/CIS 660/Assign 1/VTargetBuyUpdated.csv', 'a') as newFile:
#     newFileWriter = csv.writer(newFile)
#     brk = [30, 40, 50, 60, 70, 80, 90, 100, 110]
#     lbl = (35,45,55,65,75,85,95,105)
#     age=pd.cut(age,brk,labels=lbl,include_lowest=True)
#
#     newFileWriter.writerow(['YearlyIncome','TotalChildren','NumberChildrenAtHome','EnglishOccupation','NumberCarsOwned','DateFirstPurchase','CommuteDistance','Age'])
#     #
#     for i in range(len(yearly_income)):
#         yearly_income[i] = (yearly_income[i] - min_income)/(max_income-min_income)
#         # print(yearly_income[i])
#
#         # print(age[i])
#         newFileWriter.writerow([yearly_income[i],TotalChildren[i],NumberChildrenAtHome[i],EnglishOccupation[i],NumberCarsOwned[i],DateFirstPurchase[i],CommuteDistance[i],age[i]])
#
#
VTargetBuyUp = pd.read_csv("F:/Cleveland State University/Fall 19/CIS 660/Assign 1/VTargetBuyUpdated.csv")
# print(VTargetBuyUp)


print(VTargetBuyUp.columns)
# import numpy as np
# import matplotlib.mlab as mlab
# import matplotlib.pyplot as plt

yearly = VTargetBuyUp.values[:,0]
age = VTargetBuyUp.values[:,7]
child = VTargetBuyUp.values[:,1]
occupation = VTargetBuyUp.values[:,3]
childhome = VTargetBuyUp.values[:,2]
CarsOwned = VTargetBuyUp.values[:,4]
CommDist = VTargetBuyUp.values[:,6]

# num_bins = 5
# n, bins, patches = plt.hist(x, num_bins, facecolor='blue', alpha=0.5)
# plt.show()
# print(len(yearly))

# import plotly.graph_objects as go

# import numpy as np
x = yearly
# ----------------------Income graph-----------------------------
# fig = go.Figure(data=[go.Histogram(x=x)])
# py.plot(fig)

# Layout = go.Layout(paper_bgcolor='rgba(0,0,0,0)',plot_bgcolor='rgba(0,0,0,0)')

# ----------------------Age graph-----------------------------
# fig1 = go.Figure(data=[go.Bar(x=age,y=[j for j in range(len(age))], name='Age')],layout = Layout)
# py.plot(fig1)
#
# ----------------------Total Children graph-----------------------------
# fig2 = go.Figure(data=[go.Bar(x=child,y=[j for j in range(len(child))], name='Total Children')],layout = Layout)
# py.plot(fig2)
#
# ----------------------Children at home graph-----------------------------
# fig3 = go.Figure(data=[go.Bar(x=childhome,y=[j for j in range(len(age))], name='CHildren At Home')],layout = Layout)
# py.plot(fig3)
#
## ----------------------Cars owned graph-----------------------------
# fig4 = go.Figure(data=[go.Bar(x=CarsOwned,y=[j for j in range(len(CarsOwned))], name='Cars Owned')],layout = Layout)
# py.plot(fig4)
#
# ----------------------Commute Distance graph-----------------------------
# fig5 = go.Figure(data=[go.Bar(x=CommDist,y=[j for j in range(len(CommDist))], name='Commute Distance')],layout = Layout)
# py.plot(fig5)
#
# ----------------------Occupation graph-----------------------------
# values = occupation
#
# # Use `hole` to create a donut-like pie chart
# fig6 = go.Figure(data=[go.Pie(values=values, hole=.3)])
# py.plot(fig6)

print("Median for the Yearly Income column data is:",np.median([x]))

print("Standard Deviation for Age:", np.std(age))
print("Variance for Age:", np.var(age))

print("Standard Deviation for Total Children", np.std(child))
print("Variance for Total Children", np.var(child))

print("Standard Deviation for Children at Home", np.std(childhome))
print("Variance for Children at Home", np.var(childhome))

print("Random Sample generated by Random funciton:",random.sample(list(age), 600))

new_col = VTargetBuyUp['Age']+20
VTargetBuyUp['O1'] = new_col
VTargetBuyUp['O2'] = new_col
VTargetBuyUp['O3'] = new_col
VTargetBuyUp['O4'] = new_col
VTargetBuyUp['O5'] = new_col
VTargetBuyUp['Inc1'] = new_col
VTargetBuyUp['Inc2'] = new_col
VTargetBuyUp['Inc3'] = new_col
VTargetBuyUp['Inc4'] = new_col
VTargetBuyUp['Inc5'] = new_col
VTargetBuyUp['Child0'] = new_col
VTargetBuyUp['Child1'] = new_col
VTargetBuyUp['Child2'] = new_col
VTargetBuyUp['Child3'] = new_col
VTargetBuyUp['Child4'] = new_col
VTargetBuyUp['Child5'] = new_col
VTargetBuyUp['Car0'] = new_col
VTargetBuyUp['Car1'] = new_col
VTargetBuyUp['Car2'] = new_col
VTargetBuyUp['Car3'] = new_col
VTargetBuyUp['Car4'] = new_col
VTargetBuyUp['Com0-1'] = new_col
VTargetBuyUp['Com1-2'] = new_col
VTargetBuyUp['Com2-5'] = new_col
VTargetBuyUp['Com5-10'] = new_col
VTargetBuyUp['Com10+'] = new_col



VTargetBuyUp.to_csv('F:/Cleveland State University/Fall 19/CIS 660/Assign 1/VTargetBuyUpdated_Occ.csv', sep=',')

VTargetBuyLat = pd.read_csv('F:/Cleveland State University/Fall 19/CIS 660/Assign 1/VTargetBuyUpdated_Occ.csv')


print(VTargetBuyLat.columns)

occ1 = VTargetBuyLat.values[:,9]
occ2 = VTargetBuyLat.values[:,10]
occ3 = VTargetBuyLat.values[:,11]
occ4 = VTargetBuyLat.values[:,12]
occ5 = VTargetBuyLat.values[:,13]
inc1 = VTargetBuyLat.values[:,14]
inc2 = VTargetBuyLat.values[:,15]
inc3 = VTargetBuyLat.values[:,16]
inc4 = VTargetBuyLat.values[:,17]
inc5 = VTargetBuyLat.values[:,18]
child0 = VTargetBuyLat.values[:,19]
child1 = VTargetBuyLat.values[:,20]
child2 = VTargetBuyLat.values[:,21]
child3 = VTargetBuyLat.values[:,22]
child4 = VTargetBuyLat.values[:,23]
child5 = VTargetBuyLat.values[:,24]
car0 = VTargetBuyLat.values[:,25]
car1 = VTargetBuyLat.values[:,26]
car2 = VTargetBuyLat.values[:,27]
car3 = VTargetBuyLat.values[:,28]
car4 = VTargetBuyLat.values[:,29]
com01 = VTargetBuyLat.values[:,30]
com12 = VTargetBuyLat.values[:,31]
com25 = VTargetBuyLat.values[:,32]
com510 = VTargetBuyLat.values[:,33]
com10 = VTargetBuyLat.values[:,34]


#print(occupation)
# print(VTargetBuyUp.columns)

for i in range(len(occupation)):
    # print(occupation[i])
    if occupation[i] == 'Professional':
        occ1[i] = '1'
        occ2[i] = '0'
        occ3[i] = '0'
        occ4[i] = '0'
        occ5[i] = '0'

    elif occupation[i] == 'Manual':
        occ1[i] = '0'
        occ2[i] = '1'
        occ3[i] = '0'
        occ4[i] = '0'
        occ5[i] = '0'
    elif occupation[i] == 'Skilled Manual':
        occ1[i] = '0'
        occ2[i] = '0'
        occ3[i] = '1'
        occ4[i] = '0'
        occ5[i] = '0'
    elif occupation[i] == 'Clerical':
        occ1[i] = '0'
        occ2[i] = '0'
        occ3[i] = '0'
        occ4[i] = '1'
        occ5[i] = '0'
    elif occupation[i] == 'Management':
        occ1[i] = '0'
        occ2[i] = '0'
        occ3[i] = '0'
        occ4[i] = '0'
        occ5[i] = '1'
    else:
        print("Error occured while inserting data...")
        occ1[i] = ''
        occ2[i] = ''
        occ3[i] = ''
        occ4[i] = ''
        occ5[i] = ''


print("Success!")
# print(occ1,occ2,occ3,occ4,occ5)
VTargetBuyLat['O1']=occ1
VTargetBuyLat['O2']=occ2
VTargetBuyLat['O3']=occ3
VTargetBuyLat['O4']=occ4
VTargetBuyLat['O5']=occ5
# print(VTargetBuyLat)

print("---------------------------Income------------------------------")


for i in range(len(yearly)):
    # print(yearly[i])
    if 0< yearly[i] <= 0.2:
        inc1[i] = '1'
        inc2[i] = '0'
        inc3[i] = '0'
        inc4[i] = '0'
        inc5[i] = '0'

    elif 0.2< yearly[i] <= 0.4:
        inc1[i] = '0'
        inc2[i] = '1'
        inc3[i] = '0'
        inc4[i] = '0'
        inc5[i] = '0'
    elif 0.4< yearly[i] <= 0.6:
        inc1[i] = '0'
        inc2[i] = '0'
        inc3[i] = '1'
        inc4[i] = '0'
        inc5[i] = '0'
    elif 0.6< yearly[i] <= 0.8:
        inc1[i] = '0'
        inc2[i] = '0'
        inc3[i] = '0'
        inc4[i] = '1'
        inc5[i] = '0'
    elif 0.8< yearly[i] <= 1.0:
        inc1[i] = '0'
        inc2[i] = '0'
        inc3[i] = '0'
        inc4[i] = '0'
        inc5[i] = '1'
    else:
        print("Error occured while inserting data...")
        inc1[i] = ''
        inc2[i] = ''
        inc3[i] = ''
        inc4[i] = ''
        inc5[i] = ''


print("Success!")
# print(inc1,inc2,inc3,inc4,inc5)
VTargetBuyLat['Inc1']=inc1
VTargetBuyLat['Inc2']=inc2
VTargetBuyLat['Inc3']=inc3
VTargetBuyLat['Inc4']=inc4
VTargetBuyLat['Inc5']=inc5

# print(VTargetBuyLat)

print("-----------------------Total CHildren----------------------")


for i in range(len(child)):
    print(child[i])
    if child[i] == 0:
        child0[i] = '1'
        child1[i] = '0'
        child2[i] = '0'
        child3[i] = '0'
        child4[i] = '0'
        child5[i] = '0'

    elif child[i] == 1:
        child0[i] = '0'
        child1[i] = '1'
        child2[i] = '0'
        child3[i] = '0'
        child4[i] = '0'
        child5[i] = '0'

    elif child[i] == 2:
        child0[i] = '0'
        child1[i] = '0'
        child2[i] = '1'
        child3[i] = '0'
        child4[i] = '0'
        child5[i] = '0'

    elif child[i] == 3:
        child0[i] = '0'
        child1[i] = '0'
        child2[i] = '0'
        child3[i] = '1'
        child4[i] = '0'
        child5[i] = '0'

    elif child[i] == 4:
        child0[i] = '0'
        child1[i] = '0'
        child2[i] = '0'
        child3[i] = '0'
        child4[i] = '1'
        child5[i] = '0'

    elif child[i] == 5:
        child0[i] = '0'
        child1[i] = '0'
        child2[i] = '0'
        child3[i] = '0'
        child4[i] = '0'
        child5[i] = '1'

    else:
        print("Error occured while inserting data...")
        child0[i] = ''
        child1[i] = ''
        child2[i] = ''
        child3[i] = ''
        child4[i] = ''
        child5[i] = ''


print("Success!")
# print(child1,child2,child3,child4,child5)

VTargetBuyLat['Child0']=child0
VTargetBuyLat['Child1']=child1
VTargetBuyLat['Child2']=child2
VTargetBuyLat['Child3']=child3
VTargetBuyLat['Child4']=child4
VTargetBuyLat['Child5']=child5



print("-----------------------Cars Owned----------------------")


for i in range(len(CarsOwned)):
    print(CarsOwned[i])
    if CarsOwned[i] == 0:
        car0[i] = '1'
        car1[i] = '0'
        car2[i] = '0'
        car3[i] = '0'
        car4[i] = '0'

    elif CarsOwned[i] == 1:
        car0[i] = '0'
        car1[i] = '1'
        car2[i] = '0'
        car3[i] = '0'
        car4[i] = '0'

    elif CarsOwned[i] == 2:
        car0[i] = '0'
        car1[i] = '0'
        car2[i] = '1'
        car3[i] = '0'
        car4[i] = '0'

    elif CarsOwned[i] == 3:
        car0[i] = '0'
        car1[i] = '0'
        car2[i] = '0'
        car3[i] = '1'
        car4[i] = '0'

    elif CarsOwned[i] == 4:
        car0[i] = '0'
        car1[i] = '0'
        car2[i] = '0'
        car3[i] = '0'
        car4[i] = '1'


    else:
        print("Error occured while inserting data...")
        car0[i] = ''
        car1[i] = ''
        car2[i] = ''
        car3[i] = ''
        car4[i] = ''


print("Success!")
print(car0,car1,car2,car3,car4)

VTargetBuyLat['Car0']=car0
VTargetBuyLat['Car1']=car1
VTargetBuyLat['Car2']=car2
VTargetBuyLat['Car3']=car3
VTargetBuyLat['Car4']=car4

print("---------------------------Commute Distance------------------------------")


for i in range(len(CommuteDistance)):
    # print(CommuteDistance[i])
    if CommuteDistance[i] == '0-1 Miles':
        com01[i] = '1'
        com12[i] = '0'
        com25[i] = '0'
        com510[i] = '0'
        com10[i] = '0'

    elif CommuteDistance[i] == '1-2 Miles' :
        com01[i] = '0'
        com12[i] = '1'
        com25[i] = '0'
        com510[i] = '0'
        com10[i] = '0'
    elif CommuteDistance[i] == '2-5 Miles':
        com01[i] = '0'
        com12[i] = '0'
        com25[i] = '1'
        com510[i] = '0'
        com10[i] = '0'
    elif CommuteDistance[i] == '5-10 Miles':
        com01[i] = '0'
        com12[i] = '0'
        com25[i] = '0'
        com510[i] = '1'
        com10[i] = '0'
    elif CommuteDistance[i] == '10+ Miles':
        com01[i] = '0'
        com12[i] = '0'
        com25[i] = '0'
        com510[i] = '0'
        com10[i] = '1'
    else:
        print("Error occured while inserting data...")
        inc1[i] = ''
        inc2[i] = ''
        inc3[i] = ''
        inc4[i] = ''
        inc5[i] = ''


print("Success!")
# print(inc1,inc2,inc3,inc4,inc5)
VTargetBuyLat['Com0-1']=com01
VTargetBuyLat['Com1-2']=com12
VTargetBuyLat['Com2-5']=com25
VTargetBuyLat['Com5-10']=com510
VTargetBuyLat['Com10+']=com10



VTargetBuyLat.to_csv('F:/Cleveland State University/Fall 19/CIS 660/Assign 1/VTargetBuyUpdated_Occ.csv', sep=',')
    # print(VTargetBuyLat.values[:,10])
